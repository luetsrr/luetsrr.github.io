---
import Header from "../components/Header_.astro";
import Footer from "../components/Footer.astro";
import "katex/dist/katex.min.css";
import "remixicon/fonts/remixicon.css";
import "../styles/output.css";

const { title } = Astro.props;

// src/layouts/Layout.astro

interface Props {
  title: string;
  description?: string;
  image?: string;
}

interface Props {
  frontmatter?: {
    title: string;
    image?: string;
  };
}

// 1. Markdownから来た場合は frontmatter にデータが入っている
// 2. Astroファイルから来た場合は props に直接データが入っている
const { frontmatter } = Astro.props;

// どちらか存在する方から値を取り出す（Markdown優先の記述例）
const image = frontmatter?.image || Astro.props.image || "/images/card.png";

// (以前説明したURL設定)
const ogImageURL = new URL(image, Astro.url);
---

<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="../styles/output.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
      integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0"
      crossorigin="anonymous"
    />
    <link rel="icon" type="image/png" href="/images/logo.png">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <meta property="og:image" content={ogImageURL} />
    <meta property="og:title" content={title} />
    <meta name="twitter:image" content={ogImageURL} />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    
    <title>{title}</title>
    <meta name="description" content="「第8回うぃーすた全国交流会」を2026年7月18日(土)〜19日(日)に大阪にて開催します！">
    <script>
      // ユーザーエージェントに 'Twitter' が含まれているかチェック
      if (navigator.userAgent.indexOf('Twitter') !== -1) {
        document.body.classList.add('is-x-browser');
      }
    </script>
    
    <script>
      // --- トップへ戻るボタン ---
      document.addEventListener("DOMContentLoaded", () => {
        const backToTopButton = document.getElementById('backToTop');
        if (!backToTopButton) return;

        backToTopButton.addEventListener('click', () => {
          // これだけでブラウザが最適に滑らかにスクロールしてくれます
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        });
      });
    </script>

  </head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-J7TW1M281F"></script>
<script is:inline>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J7TW1M281F');
</script>
<!-- Google Tag Manager -->
<script is:inline>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-THDWTFBD');</script>
  <!-- End Google Tag Manager -->
<script>
  // ユーザーエージェントを取得
  var userAgent = window.navigator.userAgent.toLowerCase();
  
  // Chromeかどうか判定（EdgeやOperaを除外するための条件も含める）
  if (userAgent.indexOf('chrome') != -1 && userAgent.indexOf('edge') == -1 && userAgent.indexOf('opr') == -1) {
    document.body.classList.add('is-chrome');
  }
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // 1. ページ内リンク（#）を持ってアクセスした場合を検知
    if (window.location.hash) {
      const header = document.getElementById("mainHeader");
      if (header) {
        // 2. 強制的に不透明度を1（見える状態）にする
        // ※ requestAnimationFrameを使うことで描画のタイミングを合わせます
        window.requestAnimationFrame(() => {
          header.style.opacity = "1";
          header.style.visibility = "visible"; 
          
          // もしヘッダーが「透明背景」になってしまっている場合は、
          // 背景色クラスを適用するなどの処理もここに追加できます
          // header.classList.add("is-scrolled"); 
        });
      }
    }
  });
</script>
  <body class="flex flex-col m-0">
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-THDWTFBD"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
    <Header />
    <main class="flex-grow min-h-0">
      <slot />
    </main>
    <Footer />
  </body>
</html>